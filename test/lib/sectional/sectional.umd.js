function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(n){var r=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(n);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).sectional={})}(this,function(t){"use strict";var e=function(){function r(t,e,n){if(_classCallCheck(this,r),!(t&&e&&t in e))throw new Error("Invalid parameters: ".concat(t,", ").concat(e));this._id=t,this._data=e,this._callback="function"==typeof n?n:function(t){}}return _createClass(r,[{key:"idfmt",value:function(t){return"stnl-".concat(t)}},{key:"clsfmt",value:function(t){return"stnl-".concat(t)}},{key:"cssvarfmt",value:function(t){return"stnl".concat(t)}},{key:"attrfmt",value:function(t){return"stnl-".concat(t)}},{key:"_getData",value:function(){return this._data}},{key:"_getEntity",value:function(t){return t&&t in this._data?this._data[t]:null}}],[{key:"Template",value:function(t){return t in r.TEMPLATE?r.TEMPLATE[t]:null}}]),r}();e.TEMPLATE={entry:{children:[],title:"",type:"entry"},article:{children:[],title:"",type:"article"},section:{children:[],title:"",type:"section"},paragraph:{content:"",title:"",type:"paragraph"},code:{content:"",language:"",type:"code"},table:{classlist:"",content:{header:"",body:"",footer:""},properties:"",title:"",type:"table"},tableHeader:{children:[],type:"tableHeader"},tableColumn:{content:"",type:"tableColumn"},tableBody:{children:[],type:"tableBody"},tableRowHeader:{children:[],content:"",type:"tableRowHeader"},tableRow:{children:[],type:"tableRow"},tableCell:{content:"",type:"tableCell"},ledger:{classlist:"",content:{header:"",body:"",footer:""},properties:"",title:"",type:"ledger"},ledgerHeader:{content:{},type:"ledgerHeader"},ledgerBody:{children:[],type:"ledgerBody"},ledgerRecord:{content:{},type:"ledgerRecord"},ledgerFooter:{children:[],type:"ledgerFooter"}};var n=function(){_inherits(i,e);var r=_createSuper(i);function i(t,e,n){return _classCallCheck(this,i),r.call(this,t,e,n)}return _createClass(i,[{key:"_setAction",value:function(t,e){var n=this;if(!t)return null;t=this._getEntity(t);t&&(e.classList.add(this.clsfmt("action")),e.addEventListener("click",function(t){t=t.target;t&&t.hasAttribute("action")&&((t=t.getAttribute("action"))&&n._action(t))}),e.setAttribute("action",t.action),(t=this._getEntity(t.action))&&"url"===t.type&&e.setAttribute("title",t.content))}},{key:"_action",value:function(t){var e=this._getEntity(t);if(e)if("url"===e.type)window.open(e.content);else if("dataurl"===e.type){for(var t=e.content.split(","),e=t[0].match(/:(.*?);/)[1],n=atob(t[1]),r=n.length,i=new Uint8Array(r);r--;)i[r]=n.charCodeAt(r);window.open(URL.createObjectURL(new Blob([i],{type:e})))}}}]),i}(),r=function(){_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));var e=this._getEntity(this._id);if(e){var n=document.createElement("p");return n.id=this.idfmt(this._id),n.innerHTML=e.content,t.appendChild(n),this._callback.call(this,n),n}}}]),e}(),i=function(){_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));var e=this._getEntity(this._id);if(e){var n=document.createElement("img");return n.id=this.idfmt(this._id),n.src=e.content,t.appendChild(n),n}}}]),e}(),o=function(){_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));var e=this._getEntity(this._id);if(e){var n=document.createElement("pre");n.id=this.idfmt(this._id),t.appendChild(n);t=document.createElement("code");return t.className="language-".concat(e.language),t.innerHTML=e.content,n.appendChild(t),this._callback.call(this,n),n}}}]),e}(),a=function(){_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));t=this._getEntity(this._id);if(t)return document.createElement("ul")}}]),e}(),c=function(){_inherits(e,n);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));t=this._getEntity(this._id);if(t)return document.createElement("ol")}}]),e}(),l=function(){_inherits(i,n);var r=_createSuper(i);function i(t,e,n){_classCallCheck(this,i),(t=r.call(this,t,e,n))._headerDepth=0,t._rowHeaderDepth=0,t._classlist=[];e=t._getEntity(t._id);if(!e)throw new Error("Invalid identifier of table: ".concat(t._id));if(!("content"in e))throw new Error("Incomplete entity: ".concat(e.toString()));n=e.content;if(!("body"in n&&t._getEntity(n.body)))throw new Error("Body is necessarily required: ".concat(n.toString()));return"properties"in e&&((n=t._getEntity(e.properties))&&n.content),"classlist"in e&&((e=t._getEntity(e.classlist))&&(t._classlist=e.content)),t}return _createClass(i,[{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));var e=this._getEntity(this._id);if(e){var n=document.createElement("table");return n.id=this.idfmt(this._id),n.classList.add("stnl-table"),t.appendChild(n),e.content.header&&this._header(e.content.header,n),e.content.body&&this._body(e.content.body,n),e.content.footer&&this._footer(e.content.footer,n),n}}},{key:"_header",value:function(t,e){var r=this;if(!e)throw new Error('Invalid "parentEl": '.concat(e));var n=this._getEntity(t);if(!n)throw new Error("Invalid identifier of tableHeader: ".concat(t));var i=document.createElement("thead");i.id=this.idfmt(t),e.appendChild(i);e=function e(t){t=r._getEntity(t);if(!t)return 0;if(t.children){var n=0;return t.children.forEach(function(t){t=e(t)+1;n<t&&(i.appendChild(document.createElement("tr")),n=t)}),n}return i.appendChild(document.createElement("tr")),0};this._headerDepth=e(t),"children"in n&&n.children.length&&n.children.forEach(function(t,e){var n=r._getEntity(t);n&&"tableColumn"===n.type&&r._column(t,i,0,e)})}},{key:"_column",value:function(t,r,i,o){var a=this;if(!r)throw new Error('Invalid "parentEl": '.concat(r));var e=this._getEntity(t);if(!e)throw new Error("Invalid identifier of tableColumn: ".concat(t));var n,c=document.createElement("th");if(c.id=this.idfmt(t),c.innerHTML=e.content,r.children[i].appendChild(c),"action"in e&&e.action&&this._setAction(t,c),c.previousElementSibling&&(!c.previousElementSibling.hasAttribute("col")||(n=c.previousElementSibling.getAttribute("col"))&&(o=parseInt(n,10)),c.previousElementSibling.hasAttribute("colspan")?(n=c.previousElementSibling.getAttribute("colspan"))&&(o+=parseInt(n,10)):o+=1),c.setAttribute("col",o.toString()),c.setAttribute("row",i.toString()),this._classlist&&o<this._classlist.length&&c.classList.add.apply(c.classList,this._classlist[o]),this._callback.call(this,c),"children"in e&&e.children.length){var l=0;return e.children.forEach(function(t,e){var n=a._getEntity(t);n&&"tableColumn"===n.type&&(e=a._column(t,r,i+1,o+e)+1,l<e&&(l=e))}),1<l&&c.setAttribute("colspan",l.toString()),l}return i<this._headerDepth-1&&c.setAttribute("rowspan",(this._headerDepth-i).toString()),1}},{key:"_body",value:function(t,e){var i=this;if(!e)throw new Error('Invalid "parentEl": '.concat(e));var n=this._getEntity(t);if(!n)throw new Error("Invalid identifier of tableBody: ".concat(t));var r=document.createElement("tbody");r.id=this.idfmt(t),e.appendChild(r);e=function n(t){t=i._getEntity(t);if(!t)return 0;if("children"in t&&t.children.length){var r=0;return t.children.forEach(function(t){var e=i._getEntity(t);e&&"tableRowHeader"===e.type&&(t=n(t)+1,r<t&&(r=t))}),r}return 0};this._rowHeaderDepth=e(t),"children"in n&&n.children.length&&n.children.forEach(function(t,e){var n=i._getEntity(t);n&&("tableRowHeader"===n.type?i._rowHeader(t,r,e,0,!1):"tableRow"===n.type&&i._row(t,r,e,0,!1))})}},{key:"_rowHeader",value:function(t,o,a,c,e){var l=this;if(!o)throw new Error('Invalid "parentEl": '.concat(o));var n=this._getEntity(t);if(!n)throw new Error("Invalid identifier of tableRowHeader: ".concat(t));e||(e=document.createElement("tr"),o.appendChild(e),a=o.children.length-1);var s=document.createElement("td");if(s.id=this.idfmt(t),s.innerHTML=n.content,s.classList.add(this.clsfmt("row-header")),o.children[a].appendChild(s),"action"in n&&n.action&&this._setAction(t,s),"help"in n&&n.help&&s.setAttribute("title",n.help),s.setAttribute("row",a.toString()),s.setAttribute("col",c.toString()),this._classlist&&c<this._classlist.length&&s.classList.add.apply(s.classList,this._classlist[c]),this._callback.call(this,s),"children"in n&&n.children.length){var d=0;return n.children.forEach(function(t,e){var n=l._getEntity(t);if(n){var r=0;"tableRowHeader"!==n.type&&(r=l._rowHeaderDepth-c,s.setAttribute("colspan",r.toString()));var i=0;if("tableRowHeader"===n.type)i=l._rowHeader(t,o,a,c+(r||1),0===e);else{if("tableRow"!==n.type)throw new Error("Invalid child entity: ".concat(n.type));i=l._row(t,o,a,c+(r||1),0===e)}a+=i,d+=i}}),1<d&&s.setAttribute("rowspan",d.toString()),d}return 1}},{key:"_row",value:function(t,r,i,o,e){var a=this;if(!r)throw new Error('Invalid "parentEl": '.concat(r));var n=this._getEntity(t);if(!n)throw new Error("Invalid identifier of tableRow: ".concat(t));return e||((e=document.createElement("tr")).id=this.idfmt(t),r.appendChild(e)),"children"in n&&n.children.length&&n.children.forEach(function(t,e){var n=a._getEntity(t);n&&"tableCell"===n.type&&a._cell(t,r,i,o+e)}),1}},{key:"_cell",value:function(t,e,n,r){if(!e)throw new Error('Invalid "parentEl": '.concat(e));var i=this._getEntity(t);if(!i)throw new Error("Invalid identifier of tableCell: ".concat(t));var o=document.createElement("td");o.id=this.idfmt(t),e.children[n].appendChild(o),"action"in i&&i.action&&this._setAction(t,o),"help"in i&&i.help&&o.setAttribute("title",i.help),"highlight"in i&&i.highlight?(e=i.content.replace(/\s*\([^)]*\)\s*/g,""),o.innerHTML=i.content.substring(e.length),(t=document.createElement("strong")).innerHTML=e,o.prepend(t)):o.innerHTML=i.content,o.setAttribute("row",n.toString()),o.setAttribute("col",r.toString()),this._classlist&&r<this._classlist.length&&o.classList.add.apply(o.classList,this._classlist[r]),this._callback.call(this,o)}},{key:"_footer",value:function(t,e){}}]),i}(),s=function(){_inherits(y,n);var p=_createSuper(y);function y(t,e,n){var r;_classCallCheck(this,y),(r=p.call(this,t,e,n))._keys=[],r._types={},r._records=[],r._values={},r._mask=[],r._filter={},r._sort={},r._classlist={};t=r._getEntity(r._id);if(!t)throw new Error("Invalid identifier of ledger: ".concat(r._id));if(!("content"in t))throw new Error("Incomplete entity: ".concat(t.toString()));e=t.content;if(!("header"in e))throw new Error("Header is necessarily required: ".concat(e.toString()));if(!("body"in e))throw new Error("Body is necessarily required: ".concat(e.toString()));var i=r._getEntity(e.header);if(!i)throw new Error("Invalid identifier of ledger header: ".concat(e.header));if(!("content"in i))throw new Error("Incomplete header entity: ".concat(i));Object.keys(i.content).forEach(function(t){i&&(r._keys.push(t),r._types[t]=i.content[t])});n=r._getEntity(e.body);if(!n)throw new Error("Invalid identifier of ledger body: ".concat(e.body));if(!("children"in n))throw new Error("Incomplete body entity: ".concat(n));if(n.children.forEach(function(t){r._records.push(t)}),"properties"in t){n=r._getEntity(t.properties);if(n){n=n.content;if("display"in n&&(r._keys=[],n.display.forEach(function(t){r._keys.push(t)})),"filter"in n&&(r._filter=n.filter),"sort"in n){r._sort=n.sort;var o,a=[],c=_createForOfIteratorHelper(r._keys);try{for(c.s();!(o=c.n()).done;){var l=o.value;l in r._sort&&a.push({key:l,order:r._sort[l]})}}catch(t){c.e(t)}finally{c.f()}r.sort(a)}}}r._keys.forEach(function(t){r._classlist[t]=[]}),"classlist"in t&&((t=r._getEntity(t.classlist))&&(r._classlist=t.content));for(var s=0;s<r._records.length;s++){r._mask.push(new Array(r._keys.length));for(var d=0;d<r._keys.length;d++)r._mask[s][d]=1}var u,h=_createForOfIteratorHelper(r._keys);try{for(h.s();!(u=h.n()).done;){var f=u.value;r._values[f]=[]}}catch(t){h.e(t)}finally{h.f()}return r}return _createClass(y,[{key:"sort",value:function(l){var s=this;l&&l.length&&this._records.sort(function(t,e){for(var n=0,r=0;r<l.length&&0==n;r++){var i,o,a,c=l[r].key;c&&(i=l[r].order?"ascending"===l[r].order?1:-1:0,a=s._getEntity(t),o=s._getEntity(e),a&&o&&(n=(a=a.content[c])===(c=o.content[c])?0:(c<a?1:-1)*i))}return n})}},{key:"render",value:function(t){if(!t)throw new Error('Invalid "parentEl": '.concat(t));var e=this._getEntity(this._id);if(e){var n=document.createElement("table");return n.id=this.idfmt(this._id),n.classList.add(this.clsfmt("ledger")),t.appendChild(n),e.content.footer&&this._footer(e.content.footer,n),e.content.body&&this._body(e.content.body,n),e.content.header&&this._header(e.content.header,n),n}}},{key:"_header",value:function(t,e){var l=this;if(!e)throw new Error('Invalid "parentEl": '.concat(e));if(!this._getEntity(t))throw new Error("Invalid identifier of ledgerHeader: ".concat(t));var n=document.createElement("thead");n.id=this.idfmt(t),e.appendChild(n);var o=document.createElement("tr");n.appendChild(o);var r,n=document.createElement("th");o.appendChild(n),this._keys.forEach(function(t,e){var n=document.createElement("th");n.setAttribute("row","0"),n.setAttribute("col",e.toString()),o.appendChild(n);var r=document.createElement("input");r.type="text",r.id=l.idfmt("combobox-".concat(l._id,"-").concat(t)),r.className=l.clsfmt("filter-combobox"),r.title=t,r.placeholder=t,r.setAttribute("list",l.idfmt("datalist-".concat(l._id,"-").concat(t))),r.setAttribute("col",e.toString()),r.addEventListener("keydown",function(t){t.stopPropagation();var e=t.target;e&&"Escape"===t.key&&(e.value="",e.dispatchEvent(new Event("input")))}),r.addEventListener("keypress",function(t){t.stopPropagation()}),r.addEventListener("input",function(i,o){var a,c=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];!a&&c&&i.apply(this,n),clearTimeout(a),a=setTimeout(function(){return i.apply(t,n)},o)}}(function(t){t.stopPropagation();var i=t.target,e=l._getEntity(l._id);if(e){var n=document.querySelector("#".concat(l.idfmt(l._id))),r=n.querySelector("tbody").querySelectorAll("tr"),o=parseInt(i.getAttribute("col"))+1;if(Array.from(r).forEach(function(t,e){l._mask[e][o]=1}),i.value.length?(i.setAttribute("list",""),Array.from(r).forEach(function(t,e){try{var n=new RegExp("".concat(i.value),"gi"),r=t.childNodes[o].innerText.match(n);r&&r.length||(l._mask[e][o]=0)}catch(t){}})):(t=new RegExp("^".concat(l.idfmt("combobox")),"gi"),i.setAttribute("list",i.id.replace(t,l.idfmt("datalist")))),e.content.footer){for(var a=n.querySelector("tfoot > tr");a&&a.lastChild;)a.removeChild(a.lastChild);l._footer(e.content.footer,n)}Object.keys(l._values).forEach(function(t){l._values[t]=[]});var c=1;Array.from(r).forEach(function(t,e){var n;l._mask[e].reduce(function(t,e){return t*e})?(t.classList.remove("hidden"),n=l._records[e],l._keys.forEach(function(t){var e=l._getEntity(n);!e||(e=e.content[t])&&l._values[t].indexOf(e)<0&&l._values[t].push(e)}),t.firstElementChild&&(t.firstElementChild.innerHTML=c.toString(),c++)):t.classList.add("hidden")}),Object.keys(l._values).forEach(function(r){r in l._sort&&l._values[r].sort(function(t,e){var n=l._sort[r]?"ascending"===l._sort[r]?1:-1:0;return t==e?0:(e<t?1:-1)*n})}),l._keys.forEach(function(t,e){for(var n=l.idfmt("datalist-".concat(l._id,"-").concat(t)),r=document.querySelector("#".concat(n));r&&r.lastChild;)r.removeChild(r.lastChild);l._values[t].forEach(function(t){var e=document.createElement("option");e.value=t,e.innerHTML=t,r.appendChild(e)})})}},500)),n.appendChild(r);var i=document.createElement("datalist");i.id=l.idfmt("datalist-".concat(l._id,"-").concat(t)),n.appendChild(i),l._values[t].forEach(function(t){var e=document.createElement("option");e.value=t,e.innerHTML=t,i.appendChild(e)})}),!this._filter||(r=e.querySelectorAll(".".concat(this.clsfmt("filter-combobox")))).length&&this._keys.forEach(function(t,e){t=l._filter[t];t&&((e=r[e]).value=t,e.dispatchEvent(new Event("input")))})}},{key:"_body",value:function(t,e){var i=this;if(!e)throw new Error('Invalid "parentEl": '.concat(e));if(!this._getEntity(t))throw new Error("Invalid identifier of ledgerBody: ".concat(t));var r=document.createElement("tbody");r.id=this.idfmt(t),r.style.setProperty("--".concat(this.cssvarfmt("RowCounterId")),e.id),e.appendChild(r),this._records.forEach(function(t,e){var n=i._getEntity(t);n&&"ledgerRecord"===n.type&&i._putRecord(e+1,t,r)}),Object.keys(this._values).forEach(function(r){r in i._sort&&i._values[r].sort(function(t,e){var n=i._sort[r]?"ascending"===i._sort[r]?1:-1:0;return t==e?0:(e<t?1:-1)*n})})}},{key:"_putRecord",value:function(t,e,n){if(!n)throw new Error('Invalid "parentEl": '.concat(n));var r=this._getEntity(e);if(r){var i=document.createElement("tr");i.id=this.idfmt(e),i.style.setProperty("--".concat(this.cssvarfmt("RowCounterId")),n.id),n.appendChild(i);n=document.createElement("td");n.innerHTML=t.toString(),i.appendChild(n);var o,a=_createForOfIteratorHelper(this._keys);try{for(a.s();!(o=a.n()).done;){var c=o.value,l=document.createElement("td");i.appendChild(l);var s=r.content[c];"number"===this._types[c]||"price"===this._types[c]?s?"price"===this._types[c]?l.innerHTML=s.toLocaleString():l.innerHTML=s:l.innerHTML="0":l.innerHTML=s||"",this._classlist&&this._classlist[c].length&&l.classList.add.apply(l.classList,this._classlist[c]),s&&this._values[c].indexOf(s)<0&&this._values[c].push(s)}}catch(t){a.e(t)}finally{a.f()}}else console.log("Invalid identifier of ledgerRecord: ".concat(e))}},{key:"_footer",value:function(t,e){var a=this;if(!e)throw new Error('Invalid "parentEl": '.concat(e));var c=this._getEntity(t);if(!c)throw new Error("Invalid identifier of ledgerFooter: ".concat(t));var n=e.querySelector("tfoot");n||((n=document.createElement("tfoot")).id=this.idfmt(t),e.appendChild(n));var l=n.querySelector("tr");l||(l=document.createElement("tr"),n.appendChild(l));n=document.createElement("td");l.appendChild(n);var s,r=_createForOfIteratorHelper(this._keys);try{for(r.s();!(s=r.n()).done;)!function(){var n,r,i,o=s.value,t=c.content[o]||"",e=document.createElement("td");e.setAttribute(a.attrfmt("footer-label"),t),l.appendChild(e),"total"===t?(n=0,a._records.forEach(function(t,e){t=a._getEntity(t);t&&a._mask[e].reduce(function(t,e){return t*e})&&(n+=t.content[o])}),e.innerHTML=n.toLocaleString()):"variety"===t?(r=[],a._records.forEach(function(t,e){t=a._getEntity(t);t&&a._mask[e].reduce(function(t,e){return t*e})&&r.push(t.content[o].toString())}),e.innerHTML=_toConsumableArray(new Set(Array.from(r))).length.toLocaleString()):"count"===t&&(i=0,a._records.forEach(function(t,e){a._mask[e].reduce(function(t,e){return t*e})&&(i+=1)}),e.innerHTML=i.toLocaleString())}()}catch(t){r.e(t)}finally{r.f()}}}]),y}(),d=Object.freeze({__proto__:null,ContentEntity:n,Paragraph:r,Image:i,Code:o,Ulist:a,Olist:c,Table:l,Ledger:s}),u=function(){_inherits(i,e);var r=_createSuper(i);function i(t,e,n){return _classCallCheck(this,i),r.call(this,t,e,n)}return _createClass(i,[{key:"_children",value:function(n,t,r){var i=this;t&&t.forEach(function(t){var e=i._getEntity(t);e&&("section"===(e=e.type.toLowerCase())?i.section(t,n,r):(e=e.replace(/^.{1}/g,function(t){return t.toUpperCase()}),i._createContentEntity(e,t).render(n)))})}},{key:"_createContentEntity",value:function(t,e){var n=d;if(n[t]&&void 0!==n[t])return new n[t](e,this._getData(),this._callback);throw new Error("Class not found: "+t)}},{key:"article",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(!t||!e)throw new Error("Invalid parameters: article(id: string, parentEl: HTMLElement)");var r,i,o=this._getEntity(t);if(o){if("article"!==o.type)throw new Error("Invalid entity type: ".concat(o.type));n&&((r=document.createElement("article")).id=this.idfmt(t),e.appendChild(r),o._dom=r,o.title&&((i=document.createElement("h1")).id=this.idfmt(t),i.innerHTML=o.title,r.appendChild(i))),this._children(n?o._dom:e,o.children,n)}}},{key:"section",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(!t||!e)throw new Error("Invalid parameters: section(id: string, parentEl: HTMLElement)");var r,i,o=this._getEntity(t);if(o){if("section"!==o.type)throw new Error("Invalid entity type: ".concat(o.type));n?(r=document.createElement("section"),e.appendChild(r),o._dom=r,o.title&&((i=document.createElement("h"+o._depth)).id=this.idfmt(t),i.innerHTML=o.title,r.appendChild(i),r.setAttribute("area-label",o.title),this._callback.call(this,i))):o.title&&((i=document.createElement("h"+o._depth)).id=this.idfmt(t),i.innerHTML=o.title,e.appendChild(i),this._callback.call(this,i)),this._children(n?o._dom:e,o.children,n)}}}]),i}(),s=function(){function r(t,e,n){var o=this;if(_classCallCheck(this,r),this._callback=function(t){},this._insertSections=!0,this._entry="0000000000000000000000",!t||!e)throw new Error("Missing parameters!");this._viewport=t,this._data=e,n&&("callback"in n&&"function"==typeof n.callback&&(this._callback=n.callback),"insertSections"in n&&"boolean"==typeof n.insertSections&&(this._insertSections=n.insertSections),"entry"in n&&"string"==typeof n.entry&&(this._entry=n.entry)),function e(n,t,r){var i;!n||(i=o._data[n])&&(i._id=n,i._depth=r,t&&("_parents"in i||(i._parents=[]),i._parents.includes(t)||i._parents.push(t)),"children"in i&&i.children.forEach(function(t){e(t,n,r+1)}),"content"in i&&"object"===_typeof(i.content)&&("header"in i.content&&e(i.content.header,n,r+1),"body"in i.content&&e(i.content.body,n,r+1),"footer"in i.content&&e(i.content.footer,n,r+1)),"classlist"in i&&e(i.classlist,n,r+1),"properties"in i&&e(i.properties,n,r+1),"action"in i&&e(i.action,n,r+1))}(this._entry,"",0)}return _createClass(r,[{key:"getEntry",value:function(){return this._entry}},{key:"getData",value:function(){return this._data}},{key:"setData",value:function(t){this._data=t}},{key:"exportData",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],o=JSON.parse(JSON.stringify(this._data));return t&&Object.keys(o).forEach(function(t){for(var e=o[t],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];i.startsWith("_")&&delete e[i]}}),o}},{key:"getEntity",value:function(t){return t in this._data?this._data[t]:null}},{key:"setEntity",value:function(t,e){try{return this._data[t]=e,!0}catch(t){return!1}}},{key:"setMetadata",value:function(){}},{key:"removeEntity",value:function(t){if(t&&t in this._data){var e=this._data[t];return e&&"children"in e&&e.children,delete this._data[t],!0}return!1}},{key:"cleanup",value:function(){}},{key:"getArticles",value:function(){var t=this._data[this._entry];return t?t.children:[]}},{key:"article",value:function(t){this.clearViewport(),new u(t,this._data,this._callback).article(t,this._viewport,this._insertSections)}},{key:"clearViewport",value:function(){for(;this._viewport.lastChild;)this._viewport.removeChild(this._viewport.lastChild)}}]),r}();t.Sectional=s,Object.defineProperty(t,"__esModule",{value:!0})});
